(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,80526,e=>{"use strict";let t,s;var a,l,r,i,n,o=e.i(47167),d=e.i(43476),c=e.i(94151),x=e.i(10059),m=e.i(96390),u=e.i(75254);let h=(0,u.default)("QrCode",[["rect",{width:"5",height:"5",x:"3",y:"3",rx:"1",key:"1tu5fj"}],["rect",{width:"5",height:"5",x:"16",y:"3",rx:"1",key:"1v8r4q"}],["rect",{width:"5",height:"5",x:"3",y:"16",rx:"1",key:"1x03jg"}],["path",{d:"M21 16h-3a2 2 0 0 0-2 2v3",key:"177gqh"}],["path",{d:"M21 21v.01",key:"ents32"}],["path",{d:"M12 7v3a2 2 0 0 1-2 2H7",key:"8crl2c"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M12 3h.01",key:"n36tog"}],["path",{d:"M12 16v.01",key:"133mhm"}],["path",{d:"M16 12h1",key:"1slzba"}],["path",{d:"M21 12v.01",key:"1lwtk9"}],["path",{d:"M12 21v-1",key:"1880an"}]]);var p=e.i(74715);function f({name:e,roomNumber:t,temperature:s,infusionRate:a,status:l,dob:r,gender:i,onCardClick:n,onQrClick:o}){return(0,d.jsxs)(c.Card,{className:`relative transition-all duration-300 ${{fever:"border-status-danger border-2 bg-red-100 shadow-sm shadow-red-200",warning:"border-status-warning border-2 bg-orange-50",normal:"border-status-success border-2 bg-white"}[l]} ${n?"cursor-pointer":""} !p-3 pb-2 pt-4`,onClick:n,children:[(0,d.jsxs)("div",{className:"flex justify-between items-start mb-2",children:[(0,d.jsxs)("div",{children:[(0,d.jsx)("h4",{className:`text-lg font-bold ${"fever"===l?"text-red-700":"text-slate-800"}`,children:t}),(0,d.jsxs)("div",{className:"flex items-center gap-1.5 mt-0.5",children:[(0,d.jsx)("p",{className:`${"fever"===l?"text-red-900/70":"text-slate-600"} text-[11px] font-bold`,children:e}),(0,d.jsx)("span",{className:"text-[10px] text-slate-300",children:"|"}),(0,d.jsx)("span",{className:`text-[10px] font-bold ${"M"===i?"text-blue-500":"F"===i?"text-rose-500":"text-slate-500"}`,children:(0,p.formatPatientDemographics)(r,i)})]})]}),o&&(0,d.jsx)("button",{onClick:o,className:"p-1.5 bg-white/50 hover:bg-white rounded-lg text-slate-400 hover:text-teal-600 transition-colors",title:"보호자용 QR 코드 보기",children:(0,d.jsx)(h,{size:16})})]}),(0,d.jsxs)("div",{className:"grid grid-cols-2 gap-1.5 mt-2.5",children:[(0,d.jsxs)("div",{className:"bg-slate-100/50 p-1.5 rounded-lg flex flex-col items-center justify-center",children:[(0,d.jsxs)("div",{className:"flex items-center gap-1 text-slate-500 text-[10px] mb-0.5 font-medium",children:[(0,d.jsx)(x.Thermometer,{size:12,className:"text-status-danger"})," 체온"]}),(0,d.jsxs)("div",{className:"text-base font-bold text-slate-800",children:[s,"°"]})]}),(0,d.jsxs)("div",{className:"bg-slate-100/50 p-1.5 rounded-lg flex flex-col items-center justify-center",children:[(0,d.jsxs)("div",{className:"flex items-center gap-1 text-slate-500 text-[10px] mb-0.5 font-medium",children:[(0,d.jsx)(m.Droplet,{size:12,className:"text-primary"})," 수액"]}),(0,d.jsxs)("div",{className:"flex items-baseline gap-0.5",children:[(0,d.jsx)("span",{className:"text-base font-bold text-slate-800",children:a??"-"}),(0,d.jsx)("span",{className:"text-[10px] text-slate-400",children:"cc/hr"})]})]})]})]})}var b=e.i(45423),g=e.i(71645),v=e.i(46426),y=e.i(74080);function N({children:e}){let[t,s]=(0,g.useState)(!1);return((0,g.useEffect)(()=>(s(!0),()=>s(!1)),[]),!t||"u"<typeof document)?null:(0,y.createPortal)(e,document.body)}var j=e.i(37727);let w=(0,u.default)("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]),_={GENERAL:"일반식",SOFT:"죽",NPO:"금식"},C={RECEIPT:"영수증",DETAIL:"세부내역서",CERT:"진단서",DIAGNOSIS:"소견서",INITIAL:"기록지"},k=["흉부 X-Ray","복부 X-Ray","초음파","소변검사","혈액검사","심전도 검사","PCR 검사","신속항원검사","대변검사"],E=["301","302","303","304","305","306","307","308","309","310-1","310-2","311-1","311-2","311-3","311-4","312","313","314","315-1","315-2","315-3","315-4","401-1","401-2","401-3","401-4","402-1","402-2","402-3","402-4"];function S({isOpen:e,onClose:t,currentRoom:s,onTransfer:a}){let[l,r]=(0,g.useState)(""),[i,n]=(0,g.useState)(!1);if(!e)return null;let o=async e=>{if(e.preventDefault(),!l)return void alert("이동할 병실을 선택해주세요.");if(l===s)return void alert("현재 병실과 동일합니다.");if(confirm(`${s}호 -> ${l}호로 이동하시겠습니까?`)){n(!0);try{await a(l),t()}catch(e){console.error(e),alert("전실 처리 실패 (이미 사용 중인 병실일 수 있습니다)")}finally{n(!1)}}};return(0,d.jsx)(N,{children:(0,d.jsxs)("div",{className:"fixed inset-0 z-[10001] flex items-center justify-center p-4 animate-in fade-in duration-200",onClick:e=>e.stopPropagation(),children:[(0,d.jsx)("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-sm",onClick:e=>{e.stopPropagation(),t()}}),(0,d.jsxs)("div",{className:"relative bg-white rounded-2xl shadow-2xl w-full max-w-sm overflow-hidden z-10 border border-slate-200",onClick:e=>e.stopPropagation(),children:[(0,d.jsxs)("div",{className:"flex justify-between items-center p-5 border-b border-slate-100",children:[(0,d.jsxs)("h3",{className:"text-lg font-bold text-slate-800 flex items-center gap-2",children:[(0,d.jsx)(w,{size:20,className:"text-blue-600"}),"병실 이동 (전실)"]}),(0,d.jsx)("button",{onClick:e=>{e.stopPropagation(),t()},className:"text-slate-400 hover:text-slate-600 p-1 hover:bg-slate-100 rounded-full transition-colors",children:(0,d.jsx)(j.X,{size:20})})]}),(0,d.jsxs)("form",{onSubmit:o,className:"p-6 flex flex-col gap-6",children:[(0,d.jsxs)("div",{className:"flex items-center justify-center gap-4 bg-slate-50 py-4 rounded-xl border border-slate-100",children:[(0,d.jsxs)("div",{className:"text-center",children:[(0,d.jsx)("p",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-wider",children:"현재"}),(0,d.jsxs)("span",{className:"text-xl font-extrabold text-slate-700",children:[s,"호"]})]}),(0,d.jsx)(w,{className:"text-slate-300",size:24}),(0,d.jsxs)("div",{className:"text-center",children:[(0,d.jsx)("p",{className:"text-[10px] font-bold text-blue-400 uppercase tracking-wider",children:"이동"}),(0,d.jsxs)("span",{className:"text-xl font-extrabold text-blue-600",children:[l||"?","호"]})]})]}),(0,d.jsxs)("div",{children:[(0,d.jsx)("label",{className:"block text-sm font-bold text-slate-700 mb-2",children:"이동할 병실 선택"}),(0,d.jsxs)("select",{value:l,onChange:e=>r(e.target.value),className:"w-full p-3.5 border border-slate-200 rounded-xl focus:ring-4 focus:ring-blue-500/10 focus:border-blue-500 outline-none transition-all bg-white text-slate-700 font-medium",children:[(0,d.jsx)("option",{value:"",children:"병실을 선택해 주세요"}),E.filter(e=>e!==s).map(e=>(0,d.jsxs)("option",{value:e,children:[e,"호"]},e))]})]}),(0,d.jsx)("div",{className:"pt-2",children:(0,d.jsx)("button",{type:"submit",disabled:i||!l,className:"w-full py-4 bg-blue-600 text-white rounded-xl font-bold text-lg hover:bg-blue-700 active:scale-[0.98] transition-all disabled:opacity-50 disabled:cursor-not-allowed shadow-lg shadow-blue-500/20",children:i?"처리 중...":"이동 완료"})})]})]})]})})}var M=e.i(9165);function A({isOpen:e,onClose:t,admissionId:s,onSave:a}){let[l,r]=(0,g.useState)(""),[i,n]=(0,g.useState)(!1);if(!e)return null;let o=async e=>{if(e.preventDefault(),!l)return;let i=new Date().toISOString(),{rollback:n}=a(parseFloat(l),i);t(),r("");try{await M.api.post("/api/v1/vitals",{admission_id:s,temperature:parseFloat(l),has_medication:!1,recorded_at:i})}catch(e){n(),alert("체온 저장 실패. 다시 시도해주세요."),console.error(e)}};return(0,d.jsx)(N,{children:(0,d.jsxs)("div",{className:"fixed inset-0 z-[10001] flex items-center justify-center p-4",onClick:e=>e.stopPropagation(),children:[(0,d.jsx)("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-sm transition-opacity",onClick:e=>{e.stopPropagation(),t()}}),(0,d.jsxs)("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-xs z-10 p-6 border border-slate-200 animate-in fade-in zoom-in-95 duration-200",onClick:e=>e.stopPropagation(),children:[(0,d.jsx)("h3",{className:"text-lg font-bold text-slate-800 mb-4",children:"체온 입력"}),(0,d.jsxs)("form",{onSubmit:o,className:"space-y-4",children:[(0,d.jsxs)("div",{children:[(0,d.jsx)("label",{className:"block text-xs font-bold text-slate-500 mb-1",children:"체온 (°C)"}),(0,d.jsx)("input",{type:"number",step:"0.1",value:l,onChange:e=>r(e.target.value),className:"w-full text-lg p-3 border-2 border-slate-100 rounded-lg text-center font-bold focus:border-blue-500 outline-none",placeholder:"36.5",autoFocus:!0})]}),(0,d.jsxs)("div",{className:"flex gap-2",children:[(0,d.jsx)("button",{type:"button",onClick:t,className:"flex-1 py-3 text-sm font-bold text-slate-600 bg-slate-100 rounded-lg hover:bg-slate-200 transition-colors",children:"취소"}),(0,d.jsx)("button",{type:"submit",disabled:i||!l,className:"flex-1 py-3 text-sm font-bold text-white bg-green-500 rounded-lg hover:bg-green-600 disabled:opacity-50 transition-colors",children:i?"저장 중...":"저장"})]})]})]})]})})}var R=e.i(43531);let D=["일반식","죽1","죽2","죽3"],$=["일반식","선택 안함"];function P({isOpen:e,onClose:t,label:s,date:a,mealTime:l,mealId:r,currentPediatric:i,currentGuardian:n,onSave:o,onApiSave:c}){let[x,m]=(0,g.useState)(i),[u,h]=(0,g.useState)(n),[p,f]=(0,g.useState)(!1);if(!e)return null;let b=async e=>{e.preventDefault();let{rollback:s}=o(r,x,u);t();try{await c(x,u)}catch(e){console.error(e),s(),alert("저장 실패")}};return(0,d.jsx)(N,{children:(0,d.jsxs)("div",{className:"fixed inset-0 z-[10001] flex items-center justify-center p-4 animate-in fade-in duration-200",onClick:e=>e.stopPropagation(),children:[(0,d.jsx)("div",{className:"absolute inset-0 bg-slate-900/60 backdrop-blur-sm",onClick:e=>{e.stopPropagation(),t()}}),(0,d.jsxs)("div",{className:"bg-white rounded-[1.5rem] w-full max-w-sm shadow-2xl relative overflow-hidden flex flex-col border border-slate-200",onClick:e=>e.stopPropagation(),children:[(0,d.jsxs)("div",{className:"p-5 border-b border-slate-100 flex justify-between items-center bg-slate-50",children:[(0,d.jsxs)("div",{children:[(0,d.jsxs)("h3",{className:"text-lg font-bold text-slate-800",children:[s," 식사 수정"]}),(0,d.jsxs)("p",{className:"text-[10px] text-slate-400 font-medium uppercase tracking-wider",children:[a," / ",l]})]}),(0,d.jsx)("button",{onClick:t,className:"p-1.5 hover:bg-slate-200 rounded-full text-slate-400 transition-colors",children:(0,d.jsx)(j.X,{size:18})})]}),(0,d.jsxs)("form",{onSubmit:b,className:"p-6 space-y-5",children:[(0,d.jsxs)("div",{className:"space-y-2",children:[(0,d.jsx)("label",{className:"text-xs font-bold text-slate-500 flex items-center gap-1.5 ml-1",children:"환아 식사"}),(0,d.jsx)("div",{className:"grid grid-cols-2 gap-2",children:D.map(e=>(0,d.jsx)("button",{type:"button",onClick:()=>m(e),className:`px-3 py-2.5 rounded-xl text-xs font-bold border-2 transition-all ${x===e?"bg-blue-50 border-blue-500 text-blue-600":"bg-white border-slate-100 text-slate-400 hover:border-slate-200"}`,children:e},e))})]}),(0,d.jsxs)("div",{className:"space-y-2",children:[(0,d.jsx)("label",{className:"text-xs font-bold text-slate-500 flex items-center gap-1.5 ml-1",children:"보호자 식사"}),(0,d.jsx)("div",{className:"grid grid-cols-2 gap-2",children:$.map(e=>(0,d.jsx)("button",{type:"button",onClick:()=>h(e),className:`px-3 py-2.5 rounded-xl text-xs font-bold border-2 transition-all ${u===e?"bg-blue-50 border-blue-500 text-blue-600":"bg-white border-slate-100 text-slate-400 hover:border-slate-200"}`,children:e},e))})]}),(0,d.jsxs)("div",{className:"pt-4 flex gap-3",children:[(0,d.jsx)("button",{type:"button",onClick:t,className:"flex-1 py-3 bg-slate-50 text-slate-500 rounded-xl text-sm font-bold hover:bg-slate-100 transition-colors",children:"취소"}),(0,d.jsx)("button",{type:"submit",disabled:p,className:"flex-1 py-3 bg-blue-600 text-white rounded-xl text-sm font-bold shadow-lg shadow-blue-500/20 hover:bg-blue-700 transition-all flex items-center justify-center gap-2 disabled:opacity-50",children:p?"저장 중...":(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(R.Check,{size:18}),"저장하기"]})})]})]})]})]})})}let I=(0,u.default)("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]]);function O({isOpen:e,onClose:t,onSave:s,onApiSave:a}){let[l,r]=(0,g.useState)(""),[i,n]=(0,g.useState)(new Date().toISOString().split("T")[0]),[o,c]=(0,g.useState)("am"),[x,m]=(0,g.useState)(!1),[u,h]=(0,g.useState)(null);if(!e)return null;let p=async e=>{if(e.preventDefault(),!l)return void h("검사 항목을 선택해주세요.");h(null);let n={name:l,date:i,timeOfDay:o},{rollback:d}=s(n);t(),r("");try{await a(n)}catch(e){console.error(e),d(),alert("일정 저장에 실패했습니다.")}};return(0,d.jsx)(N,{children:(0,d.jsxs)("div",{className:"fixed inset-0 z-[10001] flex items-center justify-center p-4 animate-in fade-in active:scale-100 duration-200",onClick:e=>e.stopPropagation(),children:[(0,d.jsx)("div",{className:"absolute inset-0 bg-slate-900/60 backdrop-blur-sm",onClick:e=>{e.stopPropagation(),t()}}),(0,d.jsxs)("div",{className:"bg-white rounded-[1.5rem] w-full max-w-sm shadow-2xl relative overflow-hidden flex flex-col border border-slate-200",onClick:e=>e.stopPropagation(),children:[(0,d.jsxs)("div",{className:"p-5 border-b border-slate-100 flex justify-between items-center bg-slate-50",children:[(0,d.jsxs)("div",{className:"flex items-center gap-2",children:[(0,d.jsx)("div",{className:"p-2 bg-violet-100 text-violet-600 rounded-xl",children:(0,d.jsx)(I,{size:18})}),(0,d.jsx)("h3",{className:"text-lg font-bold text-slate-800",children:"검사 일정 등록"})]}),(0,d.jsx)("button",{onClick:t,className:"p-1.5 hover:bg-slate-200 rounded-full text-slate-400 transition-colors",children:(0,d.jsx)(j.X,{size:18})})]}),(0,d.jsxs)("form",{onSubmit:p,className:"p-6 space-y-5",children:[u&&(0,d.jsx)("div",{className:"p-3 bg-red-50 text-red-500 text-xs rounded-xl font-medium border border-red-100",children:u}),(0,d.jsxs)("div",{className:"space-y-2",children:[(0,d.jsx)("label",{className:"text-xs font-bold text-slate-500 ml-1",children:"날짜 선택"}),(0,d.jsx)("input",{type:"date",value:i,onChange:e=>n(e.target.value),className:"w-full bg-slate-50 border-2 border-slate-100 rounded-xl px-4 py-3 text-sm font-bold text-slate-700 focus:outline-none focus:border-violet-500 transition-all cursor-pointer"})]}),(0,d.jsxs)("div",{className:"space-y-2",children:[(0,d.jsx)("label",{className:"text-xs font-bold text-slate-500 ml-1",children:"시간대"}),(0,d.jsx)("div",{className:"flex gap-2",children:["am","pm"].map(e=>(0,d.jsx)("button",{type:"button",onClick:()=>c(e),className:`flex-1 py-3 rounded-xl text-sm font-bold border-2 transition-all ${o===e?"border-violet-500 bg-violet-50 text-violet-700 font-extrabold":"border-slate-100 bg-white text-slate-400"}`,children:"am"===e?"오전":"오후"},e))})]}),(0,d.jsxs)("div",{className:"space-y-2",children:[(0,d.jsx)("label",{className:"text-xs font-bold text-slate-500 ml-1",children:"검사 항목"}),(0,d.jsxs)("select",{value:l,onChange:e=>r(e.target.value),className:"w-full bg-slate-50 border-2 border-slate-100 rounded-xl px-4 py-3 text-sm font-bold text-slate-700 focus:outline-none focus:border-violet-500 transition-all cursor-pointer appearance-none",children:[(0,d.jsx)("option",{value:"",children:"검사 선택"}),k.map(e=>(0,d.jsx)("option",{value:e,children:e},e))]})]}),(0,d.jsxs)("div",{className:"pt-4 flex gap-3",children:[(0,d.jsx)("button",{type:"button",onClick:t,className:"flex-1 py-3.5 bg-slate-100 text-slate-500 rounded-xl text-sm font-bold hover:bg-slate-200 transition-colors",children:"취소"}),(0,d.jsx)("button",{type:"submit",disabled:x,className:"flex-1 py-3.5 bg-violet-600 text-white rounded-xl text-sm font-bold shadow-lg shadow-violet-200 hover:bg-violet-600 transition-all flex items-center justify-center gap-2 disabled:opacity-50",children:x?"저장 중...":(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(R.Check,{size:18}),"저장하기"]})})]})]})]})]})})}var T=e.i(29765);function z({bed:e,onClose:t,onDischarge:s,onTransfer:a,onSeedData:l,isSeeding:r}){return(0,d.jsx)("div",{className:`px-8 py-6 shrink-0 ${"fever"===e.status?"bg-red-50":"bg-slate-50"} border-b border-slate-100`,children:(0,d.jsxs)("div",{className:"flex justify-between items-start",children:[(0,d.jsxs)("div",{className:"flex items-center gap-3",children:[(0,d.jsx)("h2",{className:"text-3xl font-bold text-slate-800 tracking-tight",children:e.name}),(0,d.jsx)("span",{className:"text-xl text-slate-300 font-light",children:"/"}),(0,d.jsxs)("p",{className:"text-slate-500 font-bold text-base mt-1",children:[e.room,"호"]}),e.dob&&(0,d.jsx)("span",{className:`text-base mt-1 ml-2 font-bold ${"M"===e.gender?"text-blue-500":"F"===e.gender?"text-rose-500":"text-slate-500"}`,children:(0,p.formatPatientDemographics)(e.dob,e.gender)}),"fever"===e.status&&(0,d.jsx)("span",{className:"ml-2 px-2 py-0.5 bg-red-100 text-red-600 text-[10px] font-bold rounded-full",children:"고열 주의"})]}),(0,d.jsxs)("div",{className:"flex gap-2 -mt-1",children:[(0,d.jsx)("button",{onClick:s,className:`px-4 py-2 text-xs font-bold rounded-xl transition-all border shadow-sm ${"fever"===e.status?"bg-white border-red-500 text-red-600 hover:bg-red-600 hover:text-white":"bg-white border-red-200 text-red-600 hover:bg-red-100"}`,children:"퇴원"}),(0,d.jsx)("button",{onClick:a,className:"px-4 py-2 bg-white border border-blue-500 text-blue-600 text-xs font-bold rounded-xl hover:bg-blue-600 hover:text-white transition-all shadow-sm",children:"전실"}),(0,d.jsx)("button",{onClick:l,disabled:r,className:`px-4 py-2 bg-white border border-indigo-500 text-indigo-600 text-xs font-bold rounded-xl hover:bg-indigo-600 hover:text-white transition-all shadow-sm ${r?"opacity-50 cursor-not-allowed":""}`,title:"가상 데이터 생성 (Dev)",children:r?"생성 중...":"Dev"}),(0,d.jsx)("button",{onClick:t,className:"p-2 -mr-2 -mt-2 hover:bg-black/5 rounded-full text-slate-400 transition-colors",children:(0,d.jsx)(j.X,{size:24})})]})]})})}let F=(0,u.default)("Pen",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}]]),L=(0,u.default)("Droplets",[["path",{d:"M7 16.3c2.2 0 4-1.83 4-4.05 0-1.16-.57-2.26-1.71-3.19S7.29 6.75 7 5.3c-.29 1.45-1.14 2.84-2.29 3.76S3 11.1 3 12.25c0 2.22 1.8 4.05 4 4.05z",key:"1ptgy4"}],["path",{d:"M12.56 6.6A10.97 10.97 0 0 0 14 3.02c.5 2.5 2 4.9 4 6.5s3 3.5 3 5.5a6.98 6.98 0 0 1-11.91 4.97",key:"1sl1rz"}]]),U=(0,u.default)("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);var H=e.i(68553),B=e.i(57688),V=Object.defineProperty,q=Object.getOwnPropertySymbols,Q=Object.prototype.hasOwnProperty,Y=Object.prototype.propertyIsEnumerable,X=(e,t,s)=>t in e?V(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,G=(e,t)=>{for(var s in t||(t={}))Q.call(t,s)&&X(e,s,t[s]);if(q)for(var s of q(t))Y.call(t,s)&&X(e,s,t[s]);return e},W=(e,t)=>{var s={};for(var a in e)Q.call(e,a)&&0>t.indexOf(a)&&(s[a]=e[a]);if(null!=e&&q)for(var a of q(e))0>t.indexOf(a)&&Y.call(e,a)&&(s[a]=e[a]);return s};(e=>{let t=class t{constructor(e,s,a,r){if(this.version=e,this.errorCorrectionLevel=s,this.modules=[],this.isFunction=[],e<t.MIN_VERSION||e>t.MAX_VERSION)throw RangeError("Version value out of range");if(r<-1||r>7)throw RangeError("Mask value out of range");this.size=4*e+17;let i=[];for(let e=0;e<this.size;e++)i.push(!1);for(let e=0;e<this.size;e++)this.modules.push(i.slice()),this.isFunction.push(i.slice());this.drawFunctionPatterns();const n=this.addEccAndInterleave(a);if(this.drawCodewords(n),-1==r){let e=1e9;for(let t=0;t<8;t++){this.applyMask(t),this.drawFormatBits(t);const s=this.getPenaltyScore();s<e&&(r=t,e=s),this.applyMask(t)}}l(0<=r&&r<=7),this.mask=r,this.applyMask(r),this.drawFormatBits(r),this.isFunction=[]}static encodeText(s,a){let l=e.QrSegment.makeSegments(s);return t.encodeSegments(l,a)}static encodeBinary(s,a){let l=e.QrSegment.makeBytes(s);return t.encodeSegments([l],a)}static encodeSegments(e,a,r=1,n=40,o=-1,d=!0){let c,x;if(!(t.MIN_VERSION<=r&&r<=n&&n<=t.MAX_VERSION)||o<-1||o>7)throw RangeError("Invalid value");for(c=r;;c++){let s=8*t.getNumDataCodewords(c,a),l=i.getTotalBits(e,c);if(l<=s){x=l;break}if(c>=n)throw RangeError("Data too long")}for(let e of[t.Ecc.MEDIUM,t.Ecc.QUARTILE,t.Ecc.HIGH])d&&x<=8*t.getNumDataCodewords(c,e)&&(a=e);let m=[];for(let t of e)for(let e of(s(t.mode.modeBits,4,m),s(t.numChars,t.mode.numCharCountBits(c),m),t.getData()))m.push(e);l(m.length==x);let u=8*t.getNumDataCodewords(c,a);l(m.length<=u),s(0,Math.min(4,u-m.length),m),s(0,(8-m.length%8)%8,m),l(m.length%8==0);for(let e=236;m.length<u;e^=253)s(e,8,m);let h=[];for(;8*h.length<m.length;)h.push(0);return m.forEach((e,t)=>h[t>>>3]|=e<<7-(7&t)),new t(c,a,h,o)}getModule(e,t){return 0<=e&&e<this.size&&0<=t&&t<this.size&&this.modules[t][e]}getModules(){return this.modules}drawFunctionPatterns(){for(let e=0;e<this.size;e++)this.setFunctionModule(6,e,e%2==0),this.setFunctionModule(e,6,e%2==0);this.drawFinderPattern(3,3),this.drawFinderPattern(this.size-4,3),this.drawFinderPattern(3,this.size-4);let e=this.getAlignmentPatternPositions(),t=e.length;for(let s=0;s<t;s++)for(let a=0;a<t;a++)(0!=s||0!=a)&&(0!=s||a!=t-1)&&(s!=t-1||0!=a)&&this.drawAlignmentPattern(e[s],e[a]);this.drawFormatBits(0),this.drawVersion()}drawFormatBits(e){let t=this.errorCorrectionLevel.formatBits<<3|e,s=t;for(let e=0;e<10;e++)s=s<<1^(s>>>9)*1335;let r=(t<<10|s)^21522;l(r>>>15==0);for(let e=0;e<=5;e++)this.setFunctionModule(8,e,a(r,e));this.setFunctionModule(8,7,a(r,6)),this.setFunctionModule(8,8,a(r,7)),this.setFunctionModule(7,8,a(r,8));for(let e=9;e<15;e++)this.setFunctionModule(14-e,8,a(r,e));for(let e=0;e<8;e++)this.setFunctionModule(this.size-1-e,8,a(r,e));for(let e=8;e<15;e++)this.setFunctionModule(8,this.size-15+e,a(r,e));this.setFunctionModule(8,this.size-8,!0)}drawVersion(){if(this.version<7)return;let e=this.version;for(let t=0;t<12;t++)e=e<<1^(e>>>11)*7973;let t=this.version<<12|e;l(t>>>18==0);for(let e=0;e<18;e++){let s=a(t,e),l=this.size-11+e%3,r=Math.floor(e/3);this.setFunctionModule(l,r,s),this.setFunctionModule(r,l,s)}}drawFinderPattern(e,t){for(let s=-4;s<=4;s++)for(let a=-4;a<=4;a++){let l=Math.max(Math.abs(a),Math.abs(s)),r=e+a,i=t+s;0<=r&&r<this.size&&0<=i&&i<this.size&&this.setFunctionModule(r,i,2!=l&&4!=l)}}drawAlignmentPattern(e,t){for(let s=-2;s<=2;s++)for(let a=-2;a<=2;a++)this.setFunctionModule(e+a,t+s,1!=Math.max(Math.abs(a),Math.abs(s)))}setFunctionModule(e,t,s){this.modules[t][e]=s,this.isFunction[t][e]=!0}addEccAndInterleave(e){let s=this.version,a=this.errorCorrectionLevel;if(e.length!=t.getNumDataCodewords(s,a))throw RangeError("Invalid argument");let r=t.NUM_ERROR_CORRECTION_BLOCKS[a.ordinal][s],i=t.ECC_CODEWORDS_PER_BLOCK[a.ordinal][s],n=Math.floor(t.getNumRawDataModules(s)/8),o=r-n%r,d=Math.floor(n/r),c=[],x=t.reedSolomonComputeDivisor(i);for(let s=0,a=0;s<r;s++){let l=e.slice(a,a+d-i+(s<o?0:1));a+=l.length;let r=t.reedSolomonComputeRemainder(l,x);s<o&&l.push(0),c.push(l.concat(r))}let m=[];for(let e=0;e<c[0].length;e++)c.forEach((t,s)=>{(e!=d-i||s>=o)&&m.push(t[e])});return l(m.length==n),m}drawCodewords(e){if(e.length!=Math.floor(t.getNumRawDataModules(this.version)/8))throw RangeError("Invalid argument");let s=0;for(let t=this.size-1;t>=1;t-=2){6==t&&(t=5);for(let l=0;l<this.size;l++)for(let r=0;r<2;r++){let i=t-r,n=(t+1&2)==0?this.size-1-l:l;!this.isFunction[n][i]&&s<8*e.length&&(this.modules[n][i]=a(e[s>>>3],7-(7&s)),s++)}}l(s==8*e.length)}applyMask(e){if(e<0||e>7)throw RangeError("Mask value out of range");for(let t=0;t<this.size;t++)for(let s=0;s<this.size;s++){let a;switch(e){case 0:a=(s+t)%2==0;break;case 1:a=t%2==0;break;case 2:a=s%3==0;break;case 3:a=(s+t)%3==0;break;case 4:a=(Math.floor(s/3)+Math.floor(t/2))%2==0;break;case 5:a=s*t%2+s*t%3==0;break;case 6:a=(s*t%2+s*t%3)%2==0;break;case 7:a=((s+t)%2+s*t%3)%2==0;break;default:throw Error("Unreachable")}!this.isFunction[t][s]&&a&&(this.modules[t][s]=!this.modules[t][s])}}getPenaltyScore(){let e=0;for(let s=0;s<this.size;s++){let a=!1,l=0,r=[0,0,0,0,0,0,0];for(let i=0;i<this.size;i++)this.modules[s][i]==a?5==++l?e+=t.PENALTY_N1:l>5&&e++:(this.finderPenaltyAddHistory(l,r),a||(e+=this.finderPenaltyCountPatterns(r)*t.PENALTY_N3),a=this.modules[s][i],l=1);e+=this.finderPenaltyTerminateAndCount(a,l,r)*t.PENALTY_N3}for(let s=0;s<this.size;s++){let a=!1,l=0,r=[0,0,0,0,0,0,0];for(let i=0;i<this.size;i++)this.modules[i][s]==a?5==++l?e+=t.PENALTY_N1:l>5&&e++:(this.finderPenaltyAddHistory(l,r),a||(e+=this.finderPenaltyCountPatterns(r)*t.PENALTY_N3),a=this.modules[i][s],l=1);e+=this.finderPenaltyTerminateAndCount(a,l,r)*t.PENALTY_N3}for(let s=0;s<this.size-1;s++)for(let a=0;a<this.size-1;a++){let l=this.modules[s][a];l==this.modules[s][a+1]&&l==this.modules[s+1][a]&&l==this.modules[s+1][a+1]&&(e+=t.PENALTY_N2)}let s=0;for(let e of this.modules)s=e.reduce((e,t)=>e+ +!!t,s);let a=this.size*this.size,r=Math.ceil(Math.abs(20*s-10*a)/a)-1;return l(0<=r&&r<=9),l(0<=(e+=r*t.PENALTY_N4)&&e<=2568888),e}getAlignmentPatternPositions(){if(1==this.version)return[];{let e=Math.floor(this.version/7)+2,t=32==this.version?26:2*Math.ceil((4*this.version+4)/(2*e-2)),s=[6];for(let a=this.size-7;s.length<e;a-=t)s.splice(1,0,a);return s}}static getNumRawDataModules(e){if(e<t.MIN_VERSION||e>t.MAX_VERSION)throw RangeError("Version number out of range");let s=(16*e+128)*e+64;if(e>=2){let t=Math.floor(e/7)+2;s-=(25*t-10)*t-55,e>=7&&(s-=36)}return l(208<=s&&s<=29648),s}static getNumDataCodewords(e,s){return Math.floor(t.getNumRawDataModules(e)/8)-t.ECC_CODEWORDS_PER_BLOCK[s.ordinal][e]*t.NUM_ERROR_CORRECTION_BLOCKS[s.ordinal][e]}static reedSolomonComputeDivisor(e){if(e<1||e>255)throw RangeError("Degree out of range");let s=[];for(let t=0;t<e-1;t++)s.push(0);s.push(1);let a=1;for(let l=0;l<e;l++){for(let e=0;e<s.length;e++)s[e]=t.reedSolomonMultiply(s[e],a),e+1<s.length&&(s[e]^=s[e+1]);a=t.reedSolomonMultiply(a,2)}return s}static reedSolomonComputeRemainder(e,s){let a=s.map(e=>0);for(let l of e){let e=l^a.shift();a.push(0),s.forEach((s,l)=>a[l]^=t.reedSolomonMultiply(s,e))}return a}static reedSolomonMultiply(e,t){if(e>>>8!=0||t>>>8!=0)throw RangeError("Byte out of range");let s=0;for(let a=7;a>=0;a--)s=s<<1^(s>>>7)*285^(t>>>a&1)*e;return l(s>>>8==0),s}finderPenaltyCountPatterns(e){let t=e[1];l(t<=3*this.size);let s=t>0&&e[2]==t&&e[3]==3*t&&e[4]==t&&e[5]==t;return(s&&e[0]>=4*t&&e[6]>=t?1:0)+(s&&e[6]>=4*t&&e[0]>=t?1:0)}finderPenaltyTerminateAndCount(e,t,s){return e&&(this.finderPenaltyAddHistory(t,s),t=0),t+=this.size,this.finderPenaltyAddHistory(t,s),this.finderPenaltyCountPatterns(s)}finderPenaltyAddHistory(e,t){0==t[0]&&(e+=this.size),t.pop(),t.unshift(e)}};function s(e,t,s){if(t<0||t>31||e>>>t!=0)throw RangeError("Value out of range");for(let a=t-1;a>=0;a--)s.push(e>>>a&1)}function a(e,t){return(e>>>t&1)!=0}function l(e){if(!e)throw Error("Assertion error")}t.MIN_VERSION=1,t.MAX_VERSION=40,t.PENALTY_N1=3,t.PENALTY_N2=3,t.PENALTY_N3=40,t.PENALTY_N4=10,t.ECC_CODEWORDS_PER_BLOCK=[[-1,7,10,15,20,26,18,20,24,30,18,20,24,26,30,22,24,28,30,28,28,28,28,30,30,26,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,10,16,26,18,24,16,18,22,22,26,30,22,22,24,24,28,28,26,26,26,26,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28],[-1,13,22,18,26,18,24,18,22,20,24,28,26,24,20,30,24,28,28,26,30,28,30,30,30,30,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,17,28,22,16,22,28,26,26,24,28,24,28,22,24,24,30,28,28,26,28,30,24,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30]],t.NUM_ERROR_CORRECTION_BLOCKS=[[-1,1,1,1,1,1,2,2,2,2,4,4,4,4,4,6,6,6,6,7,8,8,9,9,10,12,12,12,13,14,15,16,17,18,19,19,20,21,22,24,25],[-1,1,1,1,2,2,4,4,4,5,5,5,8,9,9,10,10,11,13,14,16,17,17,18,20,21,23,25,26,28,29,31,33,35,37,38,40,43,45,47,49],[-1,1,1,2,2,4,4,6,6,8,8,8,10,12,16,12,17,16,18,21,20,23,23,25,27,29,34,34,35,38,40,43,45,48,51,53,56,59,62,65,68],[-1,1,1,2,4,4,4,5,6,8,8,11,11,16,16,18,16,19,21,25,25,25,34,30,32,35,37,40,42,45,48,51,54,57,60,63,66,70,74,77,81]],e.QrCode=t;let r=class e{constructor(e,t,s){if(this.mode=e,this.numChars=t,this.bitData=s,t<0)throw RangeError("Invalid argument");this.bitData=s.slice()}static makeBytes(t){let a=[];for(let e of t)s(e,8,a);return new e(e.Mode.BYTE,t.length,a)}static makeNumeric(t){if(!e.isNumeric(t))throw RangeError("String contains non-numeric characters");let a=[];for(let e=0;e<t.length;){let l=Math.min(t.length-e,3);s(parseInt(t.substring(e,e+l),10),3*l+1,a),e+=l}return new e(e.Mode.NUMERIC,t.length,a)}static makeAlphanumeric(t){let a;if(!e.isAlphanumeric(t))throw RangeError("String contains unencodable characters in alphanumeric mode");let l=[];for(a=0;a+2<=t.length;a+=2){let r=45*e.ALPHANUMERIC_CHARSET.indexOf(t.charAt(a));s(r+=e.ALPHANUMERIC_CHARSET.indexOf(t.charAt(a+1)),11,l)}return a<t.length&&s(e.ALPHANUMERIC_CHARSET.indexOf(t.charAt(a)),6,l),new e(e.Mode.ALPHANUMERIC,t.length,l)}static makeSegments(t){return""==t?[]:e.isNumeric(t)?[e.makeNumeric(t)]:e.isAlphanumeric(t)?[e.makeAlphanumeric(t)]:[e.makeBytes(e.toUtf8ByteArray(t))]}static makeEci(t){let a=[];if(t<0)throw RangeError("ECI assignment value out of range");if(t<128)s(t,8,a);else if(t<16384)s(2,2,a),s(t,14,a);else if(t<1e6)s(6,3,a),s(t,21,a);else throw RangeError("ECI assignment value out of range");return new e(e.Mode.ECI,0,a)}static isNumeric(t){return e.NUMERIC_REGEX.test(t)}static isAlphanumeric(t){return e.ALPHANUMERIC_REGEX.test(t)}getData(){return this.bitData.slice()}static getTotalBits(e,t){let s=0;for(let a of e){let e=a.mode.numCharCountBits(t);if(a.numChars>=1<<e)return 1/0;s+=4+e+a.bitData.length}return s}static toUtf8ByteArray(e){e=encodeURI(e);let t=[];for(let s=0;s<e.length;s++)"%"!=e.charAt(s)?t.push(e.charCodeAt(s)):(t.push(parseInt(e.substring(s+1,s+3),16)),s+=2);return t}};r.NUMERIC_REGEX=/^[0-9]*$/,r.ALPHANUMERIC_REGEX=/^[A-Z0-9 $%*+.\/:-]*$/,r.ALPHANUMERIC_CHARSET="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:";let i=r;e.QrSegment=r})(n||(n={})),l=(a=n||(n={})).QrCode||(a.QrCode={}),(t=class{constructor(e,t){this.ordinal=e,this.formatBits=t}}).LOW=new t(0,1),t.MEDIUM=new t(1,0),t.QUARTILE=new t(2,3),t.HIGH=new t(3,2),l.Ecc=t,i=(r=n||(n={})).QrSegment||(r.QrSegment={}),(s=class{constructor(e,t){this.modeBits=e,this.numBitsCharCount=t}numCharCountBits(e){return this.numBitsCharCount[Math.floor((e+7)/17)]}}).NUMERIC=new s(1,[10,12,14]),s.ALPHANUMERIC=new s(2,[9,11,13]),s.BYTE=new s(4,[8,16,16]),s.KANJI=new s(8,[8,10,12]),s.ECI=new s(7,[0,0,0]),i.Mode=s;var K=n,J={L:K.QrCode.Ecc.LOW,M:K.QrCode.Ecc.MEDIUM,Q:K.QrCode.Ecc.QUARTILE,H:K.QrCode.Ecc.HIGH},Z="#FFFFFF",ee="#000000";function et(e,t=0){let s=[];return e.forEach(function(e,a){let l=null;e.forEach(function(r,i){if(!r&&null!==l){s.push(`M${l+t} ${a+t}h${i-l}v1H${l+t}z`),l=null;return}if(i===e.length-1){if(!r)return;null===l?s.push(`M${i+t},${a+t} h1v1H${i+t}z`):s.push(`M${l+t},${a+t} h${i+1-l}v1H${l+t}z`);return}r&&null===l&&(l=i)})}),s.join("")}function es(e,t){return e.slice().map((e,s)=>s<t.y||s>=t.y+t.h?e:e.map((e,s)=>(s<t.x||s>=t.x+t.w)&&e))}function ea({value:e,level:t,minVersion:s,includeMargin:a,marginSize:l,imageSettings:r,size:i,boostLevel:n}){let o=g.default.useMemo(()=>{let a=(Array.isArray(e)?e:[e]).reduce((e,t)=>(e.push(...K.QrSegment.makeSegments(t)),e),[]);return K.QrCode.encodeSegments(a,J[t],s,void 0,void 0,n)},[e,t,s,n]),{cells:d,margin:c,numCells:x,calculatedImageSettings:m}=g.default.useMemo(()=>{let e=o.getModules(),t=null!=l?Math.max(Math.floor(l),0):4*!!a,s=e.length+2*t,n=function(e,t,s,a){if(null==a)return null;let l=e.length+2*s,r=Math.floor(.1*t),i=l/t,n=(a.width||r)*i,o=(a.height||r)*i,d=null==a.x?e.length/2-n/2:a.x*i,c=null==a.y?e.length/2-o/2:a.y*i,x=null==a.opacity?1:a.opacity,m=null;if(a.excavate){let e=Math.floor(d),t=Math.floor(c),s=Math.ceil(n+d-e),a=Math.ceil(o+c-t);m={x:e,y:t,w:s,h:a}}return{x:d,y:c,h:o,w:n,excavation:m,opacity:x,crossOrigin:a.crossOrigin}}(e,i,t,r);return{cells:e,margin:t,numCells:s,calculatedImageSettings:n}},[o,i,r,a,l]);return{qrcode:o,margin:c,cells:d,numCells:x,calculatedImageSettings:m}}var el=function(){try{new Path2D().addPath(new Path2D)}catch(e){return!1}return!0}(),er=g.default.forwardRef(function(e,t){let{value:s,size:a=128,level:l="L",bgColor:r=Z,fgColor:i=ee,includeMargin:n=!1,minVersion:o=1,boostLevel:d,marginSize:c,imageSettings:x}=e,m=W(e,["value","size","level","bgColor","fgColor","includeMargin","minVersion","boostLevel","marginSize","imageSettings"]),{style:u}=m,h=W(m,["style"]),p=null==x?void 0:x.src,f=g.default.useRef(null),b=g.default.useRef(null),v=g.default.useCallback(e=>{f.current=e,"function"==typeof t?t(e):t&&(t.current=e)},[t]),[y,N]=g.default.useState(!1),{margin:j,cells:w,numCells:_,calculatedImageSettings:C}=ea({value:s,level:l,minVersion:o,boostLevel:d,includeMargin:n,marginSize:c,imageSettings:x,size:a});g.default.useEffect(()=>{if(null!=f.current){let e=f.current,t=e.getContext("2d");if(!t)return;let s=w,l=b.current,n=null!=C&&null!==l&&l.complete&&0!==l.naturalHeight&&0!==l.naturalWidth;n&&null!=C.excavation&&(s=es(w,C.excavation));let o=window.devicePixelRatio||1;e.height=e.width=a*o;let d=a/_*o;t.scale(d,d),t.fillStyle=r,t.fillRect(0,0,_,_),t.fillStyle=i,el?t.fill(new Path2D(et(s,j))):w.forEach(function(e,s){e.forEach(function(e,a){e&&t.fillRect(a+j,s+j,1,1)})}),C&&(t.globalAlpha=C.opacity),n&&t.drawImage(l,C.x+j,C.y+j,C.w,C.h)}}),g.default.useEffect(()=>{N(!1)},[p]);let k=G({height:a,width:a},u),E=null;return null!=p&&(E=g.default.createElement("img",{src:p,key:p,style:{display:"none"},onLoad:()=>{N(!0)},ref:b,crossOrigin:null==C?void 0:C.crossOrigin})),g.default.createElement(g.default.Fragment,null,g.default.createElement("canvas",G({style:k,height:a,width:a,ref:v,role:"img"},h)),E)});er.displayName="QRCodeCanvas";var ei=g.default.forwardRef(function(e,t){let{value:s,size:a=128,level:l="L",bgColor:r=Z,fgColor:i=ee,includeMargin:n=!1,minVersion:o=1,boostLevel:d,title:c,marginSize:x,imageSettings:m}=e,u=W(e,["value","size","level","bgColor","fgColor","includeMargin","minVersion","boostLevel","title","marginSize","imageSettings"]),{margin:h,cells:p,numCells:f,calculatedImageSettings:b}=ea({value:s,level:l,minVersion:o,boostLevel:d,includeMargin:n,marginSize:x,imageSettings:m,size:a}),v=p,y=null;null!=m&&null!=b&&(null!=b.excavation&&(v=es(p,b.excavation)),y=g.default.createElement("image",{href:m.src,height:b.h,width:b.w,x:b.x+h,y:b.y+h,preserveAspectRatio:"none",opacity:b.opacity,crossOrigin:b.crossOrigin}));let N=et(v,h);return g.default.createElement("svg",G({height:a,width:a,viewBox:`0 0 ${f} ${f}`,ref:t,role:"img"},u),!!c&&g.default.createElement("title",null,c),g.default.createElement("path",{fill:r,d:`M0,0 h${f}v${f}H0z`,shapeRendering:"crispEdges"}),g.default.createElement("path",{fill:i,d:N,shapeRendering:"crispEdges"}),y)});ei.displayName="QRCodeSVG";let en="http://127.0.0.1:8000";function eo({admissionId:e,patientName:t,token:s,onUploadSuccess:a,lastUploadedIv:l}){let[r,i]=(0,g.useState)(""),[n,o]=(0,g.useState)(""),[c,x]=(0,g.useState)(!1),[m,u]=(0,g.useState)(!1),[h,p]=(0,g.useState)(!1),[f,b]=(0,g.useState)(!1);g.default.useEffect(()=>{l&&l.admissionId===e&&o(l.url)},[l,e]);let v=async()=>{if(!e||""===e.trim())return void alert("이 병상은 현재 입원 정보가 연동되어 있지 않아 기록을 저장할 수 없습니다.");x(!0);let t={admission_id:e,infusion_rate:r};n.trim()&&(t.photo_url=n.trim());try{let e=await fetch(`${en}/api/v1/iv-records`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(e.ok)u(!0),a(""===r?void 0:Number(r)),o(""),setTimeout(()=>u(!1),3e3);else{let t=await e.json().catch(()=>({}));alert(`Upload failed: ${t.detail||"Server error"}`)}}catch(e){console.error(e),alert("Error uploading record")}finally{x(!1)}},y=s?`${window.location.origin}/mobile/iv-upload?token=${s}`:"",N=n?n.startsWith("/")?`${en}${n}`:n:"";return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)("div",{className:`relative ${n?"ring-2 ring-orange-400 rounded-xl p-1 -m-1 bg-orange-50/50":""}`,children:[(0,d.jsxs)("div",{className:"flex items-stretch gap-2 h-10",children:[(0,d.jsxs)("div",{className:"flex-1 min-w-0 relative",children:[(0,d.jsx)("input",{type:"number",value:r,onChange:e=>i(""===e.target.value?"":Number(e.target.value)),placeholder:"0",className:"w-full h-full bg-slate-50 border border-slate-200 rounded-lg px-3 text-sm text-slate-700 focus:outline-none focus:ring-1 focus:ring-primary focus:border-primary transition font-bold"}),(0,d.jsx)("span",{className:"absolute right-3 top-1/2 -translate-y-1/2 text-xs text-slate-400 pointer-events-none",children:"cc/hr"})]}),(0,d.jsxs)("button",{onClick:v,disabled:c||m,className:`flex items-center justify-center gap-1.5 px-3 h-full rounded-lg text-xs font-bold transition-all active:scale-95 shadow-sm border whitespace-nowrap min-w-[70px] ${m?"bg-green-100 text-green-700 border-green-200":n?"bg-orange-500 text-white border-orange-600 hover:bg-orange-600 animate-pulse":"bg-slate-800 text-white border-slate-900 hover:bg-black"}`,children:[m?(0,d.jsx)(R.Check,{size:14}):(0,d.jsx)(U,{size:14}),(0,d.jsx)("span",{children:c?"저장...":m?"완료":n?"승인":"기록"})]}),(0,d.jsx)("div",{className:"flex-none h-full aspect-square relative",children:n?(0,d.jsxs)("div",{className:"w-full h-full relative bg-slate-100 rounded-lg overflow-hidden border border-slate-200 group cursor-pointer",onClick:()=>b(!0),children:[(0,d.jsx)(B.default,{src:N,alt:"Up",fill:!0,className:"object-cover"}),(0,d.jsx)("button",{onClick:e=>{e.stopPropagation(),o("")},className:"absolute top-0.5 right-0.5 bg-black/50 rounded-full p-0.5",children:(0,d.jsx)(j.X,{size:10,className:"text-white"})})]}):(0,d.jsx)("button",{onClick:()=>p(!0),className:"w-full h-full border border-slate-300 border-dashed bg-slate-50 rounded-lg flex items-center justify-center text-slate-400 hover:bg-slate-100 transition-all",title:"QR 업로드",children:(0,d.jsx)(H.Camera,{size:16})})})]}),h&&s&&(0,d.jsxs)("div",{className:"absolute top-full right-0 mt-2 bg-white z-20 flex flex-col items-center justify-center rounded-xl p-3 animate-in fade-in zoom-in-95 border border-slate-200 shadow-xl w-48",children:[(0,d.jsx)("button",{onClick:()=>p(!1),className:"absolute top-2 right-2 text-slate-300 hover:text-slate-500",children:(0,d.jsx)(j.X,{size:16})}),(0,d.jsx)("p",{className:"text-xs text-slate-600 mb-3 font-bold text-center",children:"모바일 스캔하여 업로드"}),(0,d.jsx)("div",{className:"bg-white p-1 rounded-lg border border-slate-100",children:(0,d.jsx)(er,{value:y,size:120})})]})]}),f&&N&&(0,d.jsx)("div",{className:"fixed inset-0 z-[100] bg-black/90 backdrop-blur-sm flex items-center justify-center p-4 animate-in fade-in",onClick:()=>b(!1),children:(0,d.jsxs)("div",{className:"relative w-full h-full max-w-5xl max-h-[90vh] flex flex-col items-center justify-center",children:[(0,d.jsx)("div",{className:"relative w-full h-full",children:(0,d.jsx)(B.default,{src:N,alt:"Zoomed IV",fill:!0,className:"object-contain"})}),(0,d.jsx)("p",{className:"text-white/70 mt-4 text-sm font-medium",children:"화면을 클릭하면 닫힙니다"})]})})]})}function ed({bed:e,displayTemp:t,displayVitalTime:s,meals:a,lastUploadedIv:l,onVitalModalOpen:r,onEditMeal:i,onIVUploadSuccess:n}){return(0,d.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-2 mt-4",children:[(0,d.jsx)("div",{className:"lg:col-span-7",children:(0,d.jsxs)("div",{className:"grid grid-cols-5 gap-2 h-full",children:[(0,d.jsxs)("button",{onClick:r,className:`col-span-1 bg-white rounded-[1.2rem] border-[1.5px] ${s&&(Date.now()-new Date(s).getTime())/36e5>=2?(()=>{if(!s)return"border-slate-200";let e=(Date.now()-new Date(s).getTime())/36e5;return e>=4?"border-red-500 ring-4 ring-red-100":e>=2?"border-orange-400 ring-4 ring-orange-100":"border-slate-200"})():"border-slate-200"} shadow-sm flex flex-col justify-center items-center hover:bg-slate-50 transition-all py-1.5 px-1`,children:[(0,d.jsx)("span",{className:"text-[10px] text-slate-400 block mb-0.5 font-bold uppercase tracking-tight",children:"체온"}),(0,d.jsxs)("div",{className:"flex items-center gap-0.5",children:[(0,d.jsx)("span",{className:`text-lg font-bold ${null!==t&&t>=38?"text-red-500":"text-slate-700"}`,children:null!==t?t.toFixed(1):"-"}),(0,d.jsx)("span",{className:"text-[10px] text-slate-400 font-bold mt-1",children:"°C"})]})]}),(0,d.jsxs)("div",{className:"col-span-1 bg-white rounded-[1.2rem] border-[1.5px] border-slate-200 shadow-sm flex flex-col justify-center items-center py-1.5 px-1",children:[(0,d.jsx)("span",{className:"text-[10px] text-slate-400 block mb-0.5 font-bold uppercase tracking-tight",children:"속도"}),(0,d.jsxs)("div",{className:"flex items-center gap-0.5",children:[(0,d.jsx)("span",{className:"text-lg font-bold text-slate-700",children:e.drops??"-"}),(0,d.jsx)("span",{className:"text-[10px] text-slate-400 font-bold mt-1",children:"cc/hr"})]})]}),(0,p.getNextThreeMealSlots)().map((e,t)=>{let s=a.find(t=>t.meal_date===e.date&&t.meal_time===e.meal_time);return(0,d.jsxs)("div",{className:"col-span-1 bg-white rounded-[1.2rem] border-[1.5px] border-slate-200 shadow-sm flex flex-col justify-center items-center relative group/meal py-1.5 px-1",children:[(0,d.jsx)("button",{onClick:()=>s?.id&&i({...e,mealId:s.id,pediatric:s?.pediatric_meal_type||"선택 안함",guardian:s?.guardian_meal_type||"선택 안함"}),className:"absolute top-1 right-1 p-1 text-slate-300 hover:text-slate-500 rounded-full hover:bg-slate-50 transition-colors opacity-0 group-hover/meal:opacity-100",title:`${e.label} 식사 수정`,children:(0,d.jsx)(F,{size:10})}),(0,d.jsx)("span",{className:"text-[10px] text-slate-400 block mb-0.5 font-bold uppercase tracking-tight",children:e.label}),(0,d.jsxs)("div",{className:`text-[11px] font-bold text-slate-700 flex flex-col items-center leading-tight gap-0.5 ${s?.isOptimistic?"opacity-50":""}`,children:[(0,d.jsxs)("div",{className:"flex flex-col items-center",children:[(0,d.jsx)("span",{children:s?.pediatric_meal_type||(s?"일반식":"환아식 미신청")}),s?.status==="PENDING"&&s.requested_pediatric_meal_type&&s.requested_pediatric_meal_type!==s.pediatric_meal_type&&(0,d.jsxs)("span",{className:"text-[9px] text-orange-500 font-medium",children:["→ ",s.requested_pediatric_meal_type," (신청됨)"]})]}),(0,d.jsxs)("div",{className:"flex flex-col items-center",children:[(0,d.jsx)("span",{children:s?.guardian_meal_type||(s?"신청 안함":"보호자식 미신청")}),s?.status==="PENDING"&&s.requested_guardian_meal_type&&s.requested_guardian_meal_type!==s.guardian_meal_type&&(0,d.jsxs)("span",{className:"text-[9px] text-orange-500 font-medium",children:["→ ",s.requested_guardian_meal_type," (신청됨)"]})]})]})]},`meal-slot-${e.label}-${t}`)})]})}),(0,d.jsx)("div",{className:"lg:col-span-5 h-full",children:(0,d.jsxs)("div",{className:"bg-white px-4 py-2 rounded-[1.5rem] border-[1.5px] border-slate-200 shadow-sm relative group/iv h-full flex flex-col justify-center",children:[(0,d.jsx)("div",{className:"flex items-center justify-between mb-1 px-1",children:(0,d.jsxs)("div",{className:"flex items-center gap-2",children:[(0,d.jsx)("div",{className:"p-1.5 bg-sky-50 text-sky-500 rounded-full",children:(0,d.jsx)(L,{size:14})}),(0,d.jsx)("h3",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-tight",children:"IV 수액 속도 기록"})]})}),(0,d.jsx)(eo,{admissionId:e.id,patientName:e.name,token:e.token,onUploadSuccess:e=>n?.(e),lastUploadedIv:l})]})})]})}var ec=e.i(78583);let ex=(0,u.default)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);function em({examSchedules:e,documentRequests:t,roomNotifications:s,deletingExamId:a,onAddExam:l,onDeleteExam:r,onCompleteRequest:i}){let n=g.default.useMemo(()=>s,[s]);return(0,d.jsxs)("div",{className:"lg:col-span-5 space-y-6 flex flex-col",children:[(0,d.jsxs)("section",{className:"bg-white rounded-2xl p-4 border border-slate-200 shadow-sm flex-1",children:[(0,d.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,d.jsxs)("h3",{className:"text-sm font-bold text-slate-700 flex items-center gap-2",children:[(0,d.jsx)(I,{size:16,className:"text-violet-500"}),"예정된 검사 일정"]}),(0,d.jsx)("button",{onClick:l,className:"text-[10px] bg-violet-100 text-violet-600 px-2 py-1 rounded-lg font-bold hover:bg-violet-200 transition",children:"일정 등록"})]}),(0,d.jsxs)("div",{className:"space-y-3 max-h-[160px] overflow-y-auto pr-1",children:[e.map((e,t)=>{let s,l,i;return(0,d.jsxs)("div",{className:`p-3 bg-white rounded-xl border-[1.5px] border-slate-200 shadow-sm text-xs flex justify-between items-center gap-2 ${e.isOptimistic?"opacity-50":""}`,children:[(0,d.jsx)("div",{className:"min-w-0 flex-1",children:(0,d.jsxs)("div",{className:"flex justify-between mb-0.5",children:[(0,d.jsx)("span",{className:"font-bold text-slate-700",children:e.name}),(0,d.jsx)("span",{className:"text-slate-400 shrink-0",children:(l=(s=new Date(e.scheduled_at)).getHours(),i=s.getMinutes(),l<12?`오전 ${0===l?12:l}${i?`:${i.toString().padStart(2,"0")}`:":00"}`:`오후 ${12===l?12:l-12}${i?`:${i.toString().padStart(2,"0")}`:":00"}`)})]})}),(0,d.jsx)("button",{type:"button",onClick:()=>r(e.id),disabled:a===e.id,className:"shrink-0 p-1.5 bg-red-500 text-white rounded-lg hover:bg-red-600 transition-colors shadow-sm disabled:opacity-50",title:"삭제",children:(0,d.jsx)(ex,{size:14})})]},`exam-schedule-${e.id}-${t}-${e.scheduled_at}`)}),0===e.length&&(0,d.jsx)("p",{className:"text-xs text-slate-400 text-center py-4",children:"등록된 일정이 없습니다."})]})]}),(0,d.jsxs)("section",{className:"bg-white rounded-2xl p-4 border border-slate-200 shadow-sm flex-1",children:[(0,d.jsxs)("h3",{className:"text-sm font-bold text-slate-700 mb-2 flex items-center gap-2",children:[(0,d.jsx)(ec.FileText,{size:16,className:"text-sky-500"}),"신청된 서류"]}),(0,d.jsx)("div",{className:"bg-slate-50/50 rounded-xl border border-slate-200 p-4",children:t.filter(e=>"COMPLETED"===e.status).length>0?(0,d.jsx)("div",{className:"space-y-3",children:t.filter(e=>"COMPLETED"===e.status).map((e,t)=>(0,d.jsxs)("div",{className:"space-y-1",children:[(0,d.jsxs)("div",{className:"text-[10px] text-slate-400 font-bold flex items-center gap-1.5",children:[new Date(e.created_at).toLocaleDateString()," 신청분",(0,d.jsx)("span",{className:`px-1.5 py-0.5 rounded-md text-[9px] font-bold ${"COMPLETED"===e.status?"bg-teal-100 text-teal-600":"bg-amber-100 text-amber-600"}`,children:"COMPLETED"===e.status?"완료":"대기"})]}),(0,d.jsx)("ul",{className:"space-y-1 text-xs text-slate-600",children:e.request_items.map((t,s)=>(0,d.jsxs)("li",{className:"flex items-center gap-2",children:[(0,d.jsx)("span",{className:"w-1 h-1 rounded-full bg-sky-400 shrink-0"}),C[t]||t]},`doc-item-${e.id}-${t}-${s}`))})]},`doc-request-group-${e.id}-${t}`))}):(0,d.jsx)("p",{className:"text-xs text-slate-400",children:"신청된 서류 없음"})})]}),(0,d.jsxs)("section",{className:"bg-white rounded-2xl p-4 border border-slate-200 shadow-sm flex-1",children:[(0,d.jsxs)("h3",{className:"text-sm font-bold text-slate-700 mb-4 flex items-center gap-2",children:[(0,d.jsx)(b.Bell,{size:16,className:"text-amber-500"}),"요청 사항 (",n.length,")"]}),(0,d.jsxs)("div",{className:"space-y-3 max-h-[160px] overflow-y-auto pr-1",children:[n.map((e,t)=>(0,d.jsxs)("div",{className:"p-3 bg-white rounded-xl border-[1.5px] border-slate-200 shadow-sm flex items-center justify-between gap-3",children:[(0,d.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,d.jsx)("span",{className:"text-[10px] font-bold text-slate-400 block mb-0.5",children:e.time}),(0,d.jsx)("p",{className:"text-xs text-slate-700 line-clamp-2 leading-snug",children:e.content})]}),(0,d.jsxs)("button",{onClick:()=>i(e.id,e.type),className:"px-4 py-2 bg-teal-600 text-white font-bold rounded-xl hover:bg-teal-700 transition-all flex items-center gap-1.5",children:[(0,d.jsx)(R.Check,{size:16}),"완료"]})]},`notif-${e.id}-${t}`)),0===n.length&&(0,d.jsx)("p",{className:"text-xs text-slate-400 text-center py-4",children:"대기 중인 요청이 없습니다."})]})]})]})}function eu({isOpen:e,onClose:t,bed:s,notifications:a,onCompleteRequest:l,onIVUploadSuccess:r,onVitalUpdate:i,vitals:n,checkInAt:o,lastUploadedIv:c,lastUpdated:m}){let{vitals:u,checkInAt:h,meals:p,documentRequests:f,examSchedules:b,fetchDashboardData:y,addOptimisticVital:j,addOptimisticExam:w,deleteOptimisticExam:_,updateOptimisticMeal:C}=(0,T.useVitals)(s?.token,e,t),{state:k,actions:E}=function({bed:e,onClose:t,fetchDashboardData:s,meals:a}){let[l,r]=(0,g.useState)(!1),[i,n]=(0,g.useState)(null),[o,d]=(0,g.useState)(!1),[c,x]=(0,g.useState)(!1),[m,u]=(0,g.useState)(null),[h,p]=(0,g.useState)(!1),f=async()=>{if(e?.id&&!h&&window.confirm(`[Dev] ${e.name} 환자에게 가상 데이터를 생성할까요?
(기존 체온/수액/검사 기록이 초기화됩니다.)`)){p(!0);try{await M.api.post(`/api/v1/dev/seed-patient/${e.id}`,{}),await s(),alert("데이터 생성 및 동기화 완료")}catch(e){alert("데이터 생성 실패")}finally{p(!1)}}},b=async s=>{if(e?.id)try{await M.api.post(`/api/v1/admissions/${e.id}/transfer`,{target_room:s}),alert("전실 완료"),d(!1),t(),window.location.reload()}catch(e){alert("전실 실패: 이미 사용 중인 병실이거나 오류가 발생했습니다.")}},v=async(t,s)=>{e?.id&&m&&await M.api.post("/api/v1/meals/requests",{admission_id:e.id,request_type:"STATION_UPDATE",meal_date:m.date,meal_time:m.meal_time,pediatric_meal_type:t,guardian_meal_type:s,room_note:a.find(e=>e.meal_date===m.date&&e.meal_time===m.meal_time)?.room_note||""})};return{state:{addExamModalOpen:l,deletingExamId:i,transferModalOpen:o,vitalModalOpen:c,editMealConfig:m,isSeeding:h},actions:{setAddExamModalOpen:r,setTransferModalOpen:d,setVitalModalOpen:x,setEditMealConfig:u,handleDischarge:async()=>{if(e?.id&&window.confirm(`${e.name} 환자를 퇴원 처리할까요?`))try{await M.api.post(`/api/v1/admissions/${e.id}/discharge`,{}),alert("퇴원 완료"),t(),window.location.reload()}catch(e){alert("퇴원 실패")}},handleSeedData:f,handleTransfer:b,apiAddExam:async t=>{if(!e?.id)return;let[s,a,l]=t.date.split("-").map(Number),r=new Date(s,a-1,l,"am"===t.timeOfDay?9:14,0).toISOString();await M.api.post("/api/v1/exam-schedules",{admission_id:e.id,scheduled_at:r,name:t.name.trim(),note:""})},apiDeleteExam:async e=>{n(e);try{await M.api.delete(`/api/v1/exam-schedules/${e}`)}finally{n(null)}},apiMealUpdate:v}}}({bed:s,onClose:t,fetchDashboardData:y,meals:p});(0,g.useEffect)(()=>{e&&s?.token&&y()},[e,s?.token,y]),(0,g.useEffect)(()=>{if(e)return document.body.style.overflow="hidden",()=>{document.body.style.overflow=""}},[e]);let R=(0,g.useMemo)(()=>s?a.filter(e=>String(e.room)===String(s.room)):[],[a,s]),{chartVitals:D,chartCheckIn:$}=(0,g.useMemo)(()=>s?n&&n.length>0?{chartVitals:n,chartCheckIn:o??null}:{chartVitals:u,chartCheckIn:h||o||null}:{chartVitals:[],chartCheckIn:null},[s,n,o,u,h]),I=u.length>0?u[0]:null,F=I?I.temperature:s.temp,L=I?I.recorded_at:s.last_vital_at??null;return e&&s?(0,d.jsx)(N,{children:(0,d.jsxs)("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center p-4 isolate",onClick:e=>e.stopPropagation(),children:[(0,d.jsx)("div",{className:"absolute inset-0 bg-slate-900/25 backdrop-blur-sm transition-opacity",onClick:e=>{e.stopPropagation(),t()}}),(0,d.jsxs)("div",{className:"relative z-10 bg-white rounded-[2rem] w-[75%] max-w-none max-h-[85vh] shadow-2xl overflow-hidden flex flex-col transition-all duration-300",onClick:e=>e.stopPropagation(),children:[(0,d.jsx)(z,{bed:s,onClose:t,onDischarge:E.handleDischarge,onTransfer:()=>E.setTransferModalOpen(!0),onSeedData:E.handleSeedData,isSeeding:k.isSeeding}),(0,d.jsx)("div",{className:"relative z-20 px-8 bg-slate-50 border-b border-slate-200 pb-6 shrink-0",children:(0,d.jsx)(ed,{bed:s,displayTemp:F,displayVitalTime:L,meals:p,lastUploadedIv:c,onVitalModalOpen:()=>E.setVitalModalOpen(!0),onEditMeal:E.setEditMealConfig,onIVUploadSuccess:r})}),(0,d.jsx)("div",{className:"relative z-10 flex-1 overflow-y-auto p-6 scrollbar-hide min-h-0",children:(0,d.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-6",children:[(0,d.jsx)("div",{className:"lg:col-span-7 space-y-6",children:(0,d.jsxs)("section",{className:"bg-white rounded-2xl p-4 border border-slate-200 shadow-sm",children:[(0,d.jsxs)("h3",{className:"text-sm font-bold text-slate-700 mb-4 flex items-center gap-2",children:[(0,d.jsx)(x.Thermometer,{size:16,className:"text-rose-500"}),"체온 기록 (24h)"]}),(0,d.jsx)(v.TemperatureGraph,{data:D,checkInAt:$,className:"h-auto min-h-[340px] rounded-xl border border-slate-200 bg-slate-50/50"})]})}),(0,d.jsx)(em,{examSchedules:b,documentRequests:f,roomNotifications:R,deletingExamId:k.deletingExamId,onAddExam:()=>E.setAddExamModalOpen(!0),onDeleteExam:e=>{if(!window.confirm("이 검사 일정을 삭제할까요?"))return;let{rollback:t}=_(e);E.apiDeleteExam(e).catch(e=>{t(),alert("삭제 실패")})},onCompleteRequest:(e,t)=>l?.(e,t,s.id)})]})})]}),(0,d.jsx)(S,{isOpen:k.transferModalOpen,onClose:()=>E.setTransferModalOpen(!1),onTransfer:E.handleTransfer,currentRoom:s.room}),(0,d.jsx)(A,{isOpen:k.vitalModalOpen,onClose:()=>E.setVitalModalOpen(!1),admissionId:s.id,onSave:(e,t)=>{let{rollback:s}=j(e,t);return i?.(e),{rollback:s}}}),k.editMealConfig&&(0,d.jsx)(P,{isOpen:!!k.editMealConfig,onClose:()=>E.setEditMealConfig(null),...k.editMealConfig,mealTime:k.editMealConfig.meal_time,currentPediatric:k.editMealConfig.pediatric,currentGuardian:k.editMealConfig.guardian,onSave:(e,t,s)=>C(e,t,s),onApiSave:E.apiMealUpdate}),(0,d.jsx)(O,{isOpen:k.addExamModalOpen,onClose:()=>E.setAddExamModalOpen(!1),onSave:w,onApiSave:E.apiAddExam})]})}):null}var eh=e.i(32098);function ep({isOpen:e,onClose:t,patientName:s,roomNumber:a,token:l}){let[r,i]=g.default.useState("");g.default.useEffect(()=>{i(window.location.origin)},[]);let n=`${r}/dashboard?token=${l}`;return(0,d.jsx)(eh.Modal,{isOpen:e,onClose:t,title:`보호자 대시보드 QR (${a}호 ${s})`,children:(0,d.jsxs)("div",{className:"flex flex-col items-center justify-center py-6 space-y-6",children:[(0,d.jsx)("div",{className:"bg-white p-4 rounded-xl shadow-lg border border-slate-100",children:r&&l?(0,d.jsx)(ei,{value:n,size:200,level:"H",includeMargin:!0}):(0,d.jsx)("div",{className:"w-[200px] h-[200px] bg-slate-100 animate-pulse rounded-lg flex items-center justify-center text-slate-400",children:"Loading..."})}),(0,d.jsxs)("div",{className:"text-center space-y-2",children:[(0,d.jsxs)("p",{className:"text-sm text-slate-500",children:["보호자의 스마트폰 카메라로",(0,d.jsx)("br",{}),"위 QR 코드를 스캔해 주세요."]}),(0,d.jsx)("p",{className:"text-xs text-slate-400 bg-slate-50 py-2 px-4 rounded-full font-mono mt-2 break-all",children:n})]}),(0,d.jsx)("div",{className:"w-full pt-4 border-t border-slate-100",children:(0,d.jsx)("button",{onClick:t,className:"w-full py-3 rounded-xl bg-slate-100 text-slate-600 font-bold hover:bg-slate-200 transition-colors",children:"닫기"})})]})})}let ef=(0,u.default)("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);function eb({isOpen:e,onClose:t,roomNumber:s,onAdmit:a}){let[l,r]=(0,g.useState)(""),[i,n]=(0,g.useState)(""),[o,c]=(0,g.useState)("M"),[x,m]=(0,g.useState)(!1);if(!e)return null;let u=async e=>{if(e.preventDefault(),!l.trim()||!i.trim())return void alert("이름과 생년월일을 입력해주세요.");m(!0);try{await a(l,i,o),t(),r(""),n("")}catch(e){console.error(e),alert("입원 처리 중 오류가 발생했습니다.")}finally{m(!1)}};return(0,d.jsx)(N,{children:(0,d.jsxs)("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4 min-h-screen",onClick:e=>e.stopPropagation(),children:[(0,d.jsx)("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-sm animate-in fade-in duration-200",onClick:e=>{e.stopPropagation(),t()}}),(0,d.jsxs)("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-sm overflow-hidden z-10 border border-slate-200 animate-in zoom-in-95 duration-200",onClick:e=>e.stopPropagation(),children:[(0,d.jsxs)("div",{className:"flex justify-between items-center p-5 border-b border-slate-100 bg-slate-50",children:[(0,d.jsxs)("h3",{className:"text-lg font-bold text-slate-800 flex items-center gap-2",children:[(0,d.jsx)(ef,{size:20,className:"text-teal-600"}),"입원 수속 (",s,"호)"]}),(0,d.jsx)("button",{onClick:e=>{e.stopPropagation(),t()},className:"text-slate-400 hover:text-slate-600 p-1 hover:bg-slate-200 rounded-full transition-colors",children:(0,d.jsx)(j.X,{size:20})})]}),(0,d.jsxs)("form",{onSubmit:u,className:"p-6 flex flex-col gap-6",children:[(0,d.jsxs)("div",{className:"space-y-2",children:[(0,d.jsx)("label",{className:"block text-xs font-bold text-slate-500 ml-1",children:"환자 이름"}),(0,d.jsx)("input",{type:"text",value:l,onChange:e=>r(e.target.value),placeholder:"이름 입력 (예: 김우주)",className:"w-full p-3.5 border-2 border-slate-100 rounded-xl focus:ring-4 focus:ring-teal-500/10 focus:border-teal-500 outline-none transition-all font-medium text-slate-700",autoFocus:!0})]}),(0,d.jsxs)("div",{className:"space-y-2",children:[(0,d.jsx)("label",{className:"block text-xs font-bold text-slate-500 ml-1",children:"생년월일"}),(0,d.jsx)("input",{type:"text",value:i,onChange:e=>n(e.target.value),placeholder:"YYYY-MM-DD",className:"w-full p-3.5 border-2 border-slate-100 rounded-xl focus:ring-4 focus:ring-teal-500/10 focus:border-teal-500 outline-none transition-all font-medium text-slate-700"})]}),(0,d.jsxs)("div",{className:"space-y-2",children:[(0,d.jsx)("label",{className:"block text-xs font-bold text-slate-500 ml-1",children:"성별"}),(0,d.jsxs)("div",{className:"flex gap-2",children:[(0,d.jsx)("button",{type:"button",onClick:()=>c("M"),className:`flex-1 py-3.5 rounded-xl font-bold border-2 transition-all ${"M"===o?"bg-blue-500 border-blue-500 text-white shadow-lg shadow-blue-500/20":"bg-white text-slate-400 border-slate-100"}`,children:"남아 (M)"}),(0,d.jsx)("button",{type:"button",onClick:()=>c("F"),className:`flex-1 py-3.5 rounded-xl font-bold border-2 transition-all ${"F"===o?"bg-rose-500 border-rose-500 text-white shadow-lg shadow-rose-500/20":"bg-white text-slate-400 border-slate-100"}`,children:"여아 (F)"})]})]}),(0,d.jsx)("div",{className:"pt-2",children:(0,d.jsx)("button",{type:"submit",disabled:x,className:"w-full py-4 bg-teal-600 text-white rounded-xl font-bold text-lg hover:bg-teal-700 active:scale-[0.98] transition-all disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2 shadow-lg shadow-teal-500/20",children:x?"처리 중...":"입원 완료"})})]})]})]})})}var eg=e.i(32220);let ev=["일반식","죽1","죽2","죽3","선택 안함"],ey=["일반식","선택 안함"],eN=e=>{let t=e.getFullYear(),s=String(e.getMonth()+1).padStart(2,"0"),a=String(e.getDate()).padStart(2,"0");return`${t}-${s}-${a}`},ej=e=>`${e.getMonth()+1}/${e.getDate()} (${["일","월","화","수","목","금","토"][e.getDay()]})`;function ew({beds:e}){let[t,s]=(0,g.useState)(new Date),[a,l]=(0,g.useState)({}),[r,i]=(0,g.useState)(!1),n=(0,g.useMemo)(()=>e.filter(e=>e.id&&e.name),[e]),o=[0,1,2].map(e=>{let t=new Date;return t.setDate(t.getDate()+e),t}),c=(0,g.useCallback)(async()=>{i(!0);try{let e=eN(t),s=await M.api.get(`/api/v1/meals/matrix?target_date=${e}`),a={};n.forEach(e=>{e.id&&(a[e.id]={})}),Array.isArray(s)&&s.forEach(e=>{e.admission_id&&e.meal_time&&(a[e.admission_id]||(a[e.admission_id]={}),a[e.admission_id][e.meal_time]=e)}),l(a)}catch(e){console.error("Fetch Matrix Error",e)}finally{i(!1)}},[t,n]);(0,g.useEffect)(()=>{c()},[t,c]);let x=async(e,s,r,i)=>{if(!e.id)return;let n=a[e.id]?.[s]||{};l(t=>({...t,[e.id]:{...t[e.id],[s]:{...n,[r]:i}}}));try{let a={admission_id:e.id,request_type:"STATION_UPDATE",meal_date:eN(t),meal_time:s,pediatric_meal_type:"pediatric_meal_type"===r?i:n.pediatric_meal_type||"선택 안함",guardian_meal_type:"guardian_meal_type"===r?i:n.guardian_meal_type||"선택 안함",room_note:"room_note"===r?i:n.room_note||""};await M.api.post("/api/v1/meals/requests",a)}catch(e){console.error("Update Failed",e),alert("저장 실패"),c()}},m=(e,t,s)=>{if(!e.id)return null;let l=a[e.id]?.[t],r="child"===s?l?.pediatric_meal_type||"선택 안함":l?.guardian_meal_type||"선택 안함",i="child"===s?l?.requested_pediatric_meal_type:l?.requested_guardian_meal_type,n=l?.status==="PENDING"&&i&&i!==r;return(0,d.jsx)("td",{className:`p-0 border border-slate-300 h-[32px] relative ${n?"bg-orange-50":""}`,children:(0,d.jsxs)("div",{className:"flex items-center h-full",children:[(0,d.jsx)("select",{className:`flex-1 h-full text-center bg-transparent border-none text-xs focus:ring-inset focus:ring-1 focus:ring-blue-500 cursor-pointer ${"선택 안함"!==r?"font-bold text-slate-800":"text-slate-400"}`,value:r,onChange:a=>x(e,t,"child"===s?"pediatric_meal_type":"guardian_meal_type",a.target.value),children:("child"===s?ev:ey).map(e=>(0,d.jsx)("option",{value:e,children:e},e))}),n&&(0,d.jsx)("button",{title:`환자 신청: ${i}`,onClick:()=>x(e,t,"child"===s?"pediatric_meal_type":"guardian_meal_type",i),className:"absolute -top-1 -right-1 w-4 h-4 bg-orange-500 text-white rounded-full flex items-center justify-center text-[10px] font-bold hover:bg-orange-600 shadow-sm z-10 animate-pulse",children:"!"})]})})};return(0,d.jsxs)("div",{className:"bg-white rounded-xl shadow p-4 h-full overflow-hidden flex flex-col",children:[(0,d.jsxs)("div",{className:"flex justify-between items-end mb-2",children:[(0,d.jsx)("div",{className:"flex gap-1",children:o.map((e,a)=>{let l=eN(e)===eN(t);return(0,d.jsx)("button",{onClick:()=>s(e),className:`px-4 py-2 rounded-t-lg text-sm font-bold border-t border-x transition-colors ${l?"bg-white border-slate-300 text-teal-700 z-10 -mb-[1px]":"bg-slate-100 border-transparent text-slate-500 hover:bg-slate-200"}`,children:ej(e)},a)})}),(0,d.jsxs)("div",{className:"flex gap-2 items-center mb-1",children:[(0,d.jsx)("button",{onClick:async()=>{if(window.confirm(`[Dev] ${ej(t)}의 모든 환자 식단을 생성할까요?`))try{await M.api.post(`/api/v1/dev/seed-meals?target_date=${eN(t)}`,{}),c(),alert("식단 생성 완료")}catch(e){alert("생성 실패")}},className:"px-3 py-1.5 text-[10px] bg-indigo-50 text-indigo-600 border border-indigo-200 rounded-lg hover:bg-indigo-100 font-bold",children:"식단 일괄 생성 (Dev)"}),(0,d.jsx)("div",{className:"text-xs text-slate-400",children:r?"로딩중...":"자동 저장됨"})]})]}),(0,d.jsx)("div",{className:"flex-1 overflow-auto border border-slate-300 relative bg-white",children:(0,d.jsxs)("table",{className:"w-full text-xs text-left border-collapse",children:[(0,d.jsxs)("thead",{className:"bg-slate-100 text-slate-700 font-bold sticky top-0 z-20 shadow-sm",children:[(0,d.jsxs)("tr",{children:[(0,d.jsx)("th",{className:"px-2 py-1.5 border border-slate-300 text-center w-[60px]",rowSpan:2,children:"병실"}),(0,d.jsx)("th",{className:"px-2 py-1.5 border border-slate-300 text-center w-[80px]",rowSpan:2,children:"환자명"}),(0,d.jsx)("th",{className:"px-1 py-1 border border-slate-300 text-center",colSpan:2,children:"아침"}),(0,d.jsx)("th",{className:"px-1 py-1 border border-slate-300 text-center",colSpan:2,children:"점심"}),(0,d.jsx)("th",{className:"px-1 py-1 border border-slate-300 text-center",colSpan:2,children:"저녁"}),(0,d.jsx)("th",{className:"px-2 py-1.5 border border-slate-300 text-center min-w-[150px]",rowSpan:2,children:"비고"})]}),(0,d.jsxs)("tr",{children:[(0,d.jsx)("th",{className:"px-1 py-1 border border-slate-300 text-center w-[90px] bg-slate-50",children:"환아"}),(0,d.jsx)("th",{className:"px-1 py-1 border border-slate-300 text-center w-[90px] bg-slate-50",children:"보호자"}),(0,d.jsx)("th",{className:"px-1 py-1 border border-slate-300 text-center w-[90px] bg-slate-50",children:"환아"}),(0,d.jsx)("th",{className:"px-1 py-1 border border-slate-300 text-center w-[90px] bg-slate-50",children:"보호자"}),(0,d.jsx)("th",{className:"px-1 py-1 border border-slate-300 text-center w-[90px] bg-slate-50",children:"환아"}),(0,d.jsx)("th",{className:"px-1 py-1 border border-slate-300 text-center w-[90px] bg-slate-50",children:"보호자"})]})]}),(0,d.jsxs)("tbody",{children:[n.map(e=>(0,d.jsxs)("tr",{className:"hover:bg-blue-50 transition-colors",children:[(0,d.jsx)("td",{className:"px-2 py-1 border border-slate-300 text-center font-bold bg-slate-50",children:e.room}),(0,d.jsx)("td",{className:"px-2 py-1 border border-slate-300 text-center font-bold text-slate-900",children:e.name}),m(e,"BREAKFAST","child"),m(e,"BREAKFAST","guardian"),m(e,"LUNCH","child"),m(e,"LUNCH","guardian"),m(e,"DINNER","child"),m(e,"DINNER","guardian"),(0,d.jsx)("td",{className:"p-0 border border-slate-300 h-[32px]",children:(0,d.jsx)("input",{type:"text",className:"w-full h-full px-2 bg-transparent border-none text-xs focus:ring-inset focus:ring-1 focus:ring-blue-500",placeholder:"-",defaultValue:a[e.id]?.LUNCH?.room_note||"",onBlur:t=>{let s=a[e.id]?.LUNCH?.room_note||"";t.target.value!==s&&x(e,"LUNCH","room_note",t.target.value)}})})]},e.room)),0===n.length&&(0,d.jsx)("tr",{children:(0,d.jsx)("td",{colSpan:9,className:"text-center py-10 text-slate-400 border border-slate-300",children:"입원 중인 환자가 없습니다."})})]})]})})]})}function e_(){let{stationData:e,state:t,actions:s}=function(){let e=function(){let[e,t]=(0,g.useState)([]),[s,a]=(0,g.useState)([]),[l,r]=(0,g.useState)(null),[i,n]=(0,g.useState)(Date.now()),d=(0,g.useRef)(0),c=(0,g.useCallback)(async()=>{try{let e=await M.api.get("/api/v1/station/pending-requests");Array.isArray(e)&&a(e.map(e=>({...e,time:new Date(e.time).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})))}catch(e){console.error("Failed to fetch pending requests",e)}},[]),x=(0,g.useCallback)(()=>{let e=Date.now();e-d.current<500||(d.current=e,M.api.get("/api/v1/admissions").then(e=>{Array.isArray(e)&&t(E.map((t,s)=>{let a=e.find(e=>String(e.room_number).trim()===String(t).trim());return a?{id:a.id,room:t,name:a.display_name,token:a.access_token,drops:a.latest_iv?a.latest_iv.infusion_rate:null,temp:a.latest_temp??null,had_fever_in_6h:a.had_fever_in_6h,status:null!=a.latest_temp&&a.latest_temp>=38||a.had_fever_in_6h?"fever":"normal",latest_meal:a.latest_meal??void 0,last_vital_at:a.last_vital_at??void 0,dob:a.dob,gender:a.gender}:{id:"",room:t,name:`환자${s+1}`,temp:null,drops:null,status:"normal",token:""}}))}).catch(console.error))},[]);(0,g.useEffect)(()=>{t(E.map((e,t)=>({id:"",room:e,name:`환자${t+1}`,temp:null,drops:null,status:"normal",token:""}))),x(),c()},[x,c]);let m=(0,g.useCallback)(e=>{try{let s=JSON.parse(e.data);switch(Math.random().toString(36).substr(2,9),s.type){case"NEW_MEAL_REQUEST":if("STATION_UPDATE"===s.data.request_type)break;let l=s.data.pediatric_meal_type,i=s.data.guardian_meal_type,n="";l&&(n=l),i&&"선택 안함"!==i&&(n+=(n?" / ":"")+i),n||(n=_[s.data.request_type]||s.data.request_type);let o=s.data.meal_date,d=s.data.meal_time,c="";if(o){let e=o.split("-");c=3===e.length?`${e[1]}/${e[2]}`:o}let m=`meal_${s.data.id}`,u={id:m,room:s.data.room,time:"방금",content:s.data.content||`[${c} ${({BREAKFAST:"아침",LUNCH:"점심",DINNER:"저녁"})[d]||d}] 식단 신청 (${n})`,type:"meal",admissionId:s.data.admission_id};a(e=>e.some(e=>e.id===m)?e.map(e=>e.id===m?u:e):[u,...e]),t(e=>e.map(e=>String(e.room)===String(s.data.room)?{...e,latest_meal:{id:s.data.id,admission_id:s.data.admission_id,request_type:s.data.request_type,pediatric_meal_type:e.latest_meal?.pediatric_meal_type,guardian_meal_type:e.latest_meal?.guardian_meal_type,requested_pediatric_meal_type:s.data.requested_pediatric_meal_type||s.data.pediatric_meal_type,requested_guardian_meal_type:s.data.requested_guardian_meal_type||s.data.guardian_meal_type,status:"PENDING",created_at:new Date().toISOString(),meal_date:s.data.meal_date,meal_time:s.data.meal_time}}:e));break;case"NEW_DOC_REQUEST":let h=s.data.request_items.map(e=>C[e]||e),p=`doc_${s.data.id}`,f={id:p,room:s.data.room,time:"방금",content:s.data.content||`서류 신청 (${h.join(", ")})`,type:"doc",admissionId:s.data.admission_id};a(e=>e.some(e=>e.id===p)?e.map(e=>e.id===p?f:e):[f,...e]);break;case"DOC_REQUEST_UPDATED":a(e=>e.filter(e=>e.id!==`doc_${s.data.id}`));break;case"IV_PHOTO_UPLOADED":r({admissionId:s.data.admission_id,url:s.data.photo_url});break;case"NEW_IV":let b=s.data.infusion_rate,g=s.data.room;t(e=>e.map(e=>String(e.room)===String(g)?{...e,drops:b}:e));break;case"NEW_VITAL":let v=s.data;t(e=>e.map(e=>{if(e.id===v.admission_id){let t=v.temperature>=38;return{...e,temp:v.temperature,last_vital_at:v.recorded_at,had_fever_in_6h:e.had_fever_in_6h||t,status:t||e.had_fever_in_6h?"fever":"normal"}}return e}));break;case"NEW_EXAM_SCHEDULE":case"DELETE_EXAM_SCHEDULE":break;case"ADMISSION_TRANSFERRED":case"ADMISSION_DISCHARGED":case"REFRESH_DASHBOARD":x()}}catch(e){console.error("WS Parse Error",e)}},[t,a,n,r,x]),u=o.default.env.NEXT_PUBLIC_STATION_WS_TOKEN||"STATION",{isConnected:h}=(0,eg.useWebSocket)({url:`${M.api.getBaseUrl().replace(/^http/,"ws")}/ws/${u}`,enabled:!0,onOpen:()=>{x(),c()},onMessage:m}),p=(0,g.useCallback)(async(e,t,s)=>{a(t=>t.filter(t=>t.id!==e));let l=e.match(/^(meal|doc)_(\d+)$/);if(s&&l)try{let[,e,s]=l;await M.api.patch(`/api/v1/${"doc"===(t||e)?"documents":"meals"}/requests/${s}?status=COMPLETED`,{})}catch(e){console.error("Status Update Failed",e)}},[]);return{beds:e,setBeds:t,notifications:s,setNotifications:a,lastUploadedIv:l,lastUpdated:i,isConnected:h,removeNotification:p,fetchAdmissions:x}}(),{beds:t,setBeds:s,notifications:a,removeNotification:l,fetchAdmissions:r}=e,[i,n]=(0,g.useState)(null),[d,c]=(0,g.useState)(null),[x,m]=(0,g.useState)(null),[u,h]=(0,g.useState)("patients"),p=(0,g.useMemo)(()=>i&&t.find(e=>String(e.room)===i)||null,[t,i]),f=(0,g.useCallback)(async(e,t,s)=>{if(!x)return;let a=t.trim();/^\d{8}$/.test(a)&&(a=`${a.substring(0,4)}-${a.substring(4,6)}-${a.substring(6,8)}`);try{let t=new Date(a),l=new Date;if(t>l)return void alert("생년월일은 오늘 이후 날짜일 수 없습니다.");let i=l.getFullYear()-t.getFullYear(),n=l.getMonth()-t.getMonth();if((n<0||0===n&&l.getDate()<t.getDate())&&i--,i>=19)return void alert("만 19세 이상 성인은 입원이 불가능합니다.");await M.api.post("/api/v1/admissions",{patient_name:e,room_number:x,dob:a,gender:s}),alert("입원 수속이 완료되었습니다."),m(null),r()}catch(e){console.error(e),alert(`입원 처리 실패: ${e.message||"알 수 없는 오류"}`)}},[x,r]),b=(0,g.useCallback)(e=>{t.find(t=>t.room===e.room)?n(e.room):window.confirm(`${e.room}호 변동사항을 확인하시겠습니까? (환자 정보 없음)`)&&l(e.id)},[t,l]);return{stationData:e,state:{selectedRoom:i,qrBed:d,admitRoom:x,activeTab:u,selectedBed:p},actions:{setSelectedRoom:n,setQrBed:c,setAdmitRoom:m,setActiveTab:h,handleAdmit:f,handleNotificationClick:b,handleDischargeAll:(0,g.useCallback)(async()=>{if(confirm("경고: DEV 모드 전용입니다.\n모든 환자를 퇴원 처리하시겠습니까?"))try{await M.api.post("/api/v1/dev/discharge-all",{}),await r(),alert("모든 환자가 퇴원 처리되었습니다.")}catch(e){console.error("Discharge Error:",e),alert("퇴원 처리 중 오류가 발생했습니다.")}},[r]),handleSeedSingle:(0,g.useCallback)(async()=>{try{let e=await M.api.post("/api/v1/dev/seed-single",{});e.error?alert(`생성 실패: ${e.error}`):(await r(),alert(e.message||"더미 환자가 생성되었습니다."))}catch(e){console.error("Seed Error:",e),alert(`더미 생성 중 오류가 발생했습니다: ${e.message}`)}},[r]),setBeds:s}}}(),{beds:a,notifications:l,lastUploadedIv:r,lastUpdated:i,removeNotification:n}=e,{selectedRoom:x,qrBed:m,admitRoom:u,activeTab:h,selectedBed:p}=t;return(0,d.jsxs)("div",{className:"flex h-screen bg-slate-100 overflow-hidden",children:[(0,d.jsxs)("main",{className:"flex-1 p-2 overflow-y-auto flex flex-col",children:[(0,d.jsxs)("header",{className:"flex justify-between items-center mb-2 px-1 shrink-0",children:[(0,d.jsxs)("div",{className:"flex items-center gap-4",children:[(0,d.jsx)("div",{className:"relative h-14 w-32",children:(0,d.jsx)(B.default,{src:"/eco_logo.png",alt:"Eco Pediatrics",fill:!0,className:"object-contain object-left"})}),(0,d.jsxs)("div",{className:"flex gap-2",children:[(0,d.jsx)("button",{onClick:()=>s.setActiveTab("patients"),className:`px-4 py-2 rounded-lg font-bold transition-colors ${"patients"===h?"bg-teal-600 text-white":"bg-white text-slate-600"}`,children:"환자 리스트"}),(0,d.jsx)("button",{onClick:()=>s.setActiveTab("meals"),className:`px-4 py-2 rounded-lg font-bold transition-colors ${"meals"===h?"bg-teal-600 text-white":"bg-white text-slate-600"}`,children:"식단 관리"}),(0,d.jsxs)("div",{className:"flex gap-1 ml-2",children:[(0,d.jsx)("button",{onClick:s.handleDischargeAll,className:"px-3 py-2 text-xs bg-red-50 text-red-500 border border-red-200 rounded hover:bg-red-100 font-bold",children:"DEV: 전체퇴원"}),(0,d.jsx)("button",{onClick:s.handleSeedSingle,className:"px-3 py-2 text-xs bg-indigo-50 text-indigo-500 border border-indigo-200 rounded hover:bg-indigo-100 font-bold",children:"DEV: 환자추가"})]})]})]}),(0,d.jsxs)("div",{className:"text-slate-500 text-xs",children:["Total: ",a.length]})]}),"patients"===h&&(0,d.jsx)("div",{className:"grid grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 gap-1.5 pb-20",children:a.map(e=>e.id?(0,d.jsx)(f,{name:e.name,roomNumber:e.room,temperature:null!==e.temp?e.temp.toFixed(1):"-",infusionRate:e.drops??"-",status:e.status,onCardClick:()=>s.setSelectedRoom(e.room),onQrClick:t=>{t.stopPropagation(),e.token?s.setQrBed(e):alert("토큰 없음")},dob:e.dob,gender:e.gender},e.room):(0,d.jsxs)("div",{className:"h-[140px] border-2 border-dashed border-slate-200 rounded-xl flex flex-col items-center justify-center bg-slate-50/50 hover:bg-slate-50 transition-colors",children:[(0,d.jsx)("div",{className:"text-lg font-bold text-slate-400 mb-2",children:e.room}),(0,d.jsx)("button",{onClick:()=>s.setAdmitRoom(e.room),className:"px-3 py-1.5 bg-teal-600 text-white text-xs font-bold rounded-lg hover:bg-teal-700",children:"입원"})]},e.room))}),"meals"===h&&(0,d.jsx)("div",{className:"flex-1 overflow-hidden p-1",children:(0,d.jsx)(ew,{beds:a})})]}),(0,d.jsxs)("aside",{className:"w-80 bg-white border-l border-slate-200 p-4 flex flex-col gap-4",children:[(0,d.jsxs)("div",{className:"flex items-center gap-2 mb-2 text-slate-800 font-semibold",children:[(0,d.jsx)(b.Bell,{size:20,className:"text-teal-500"}),(0,d.jsx)("span",{children:"Recent Requests"})]}),(0,d.jsx)("div",{className:"flex flex-col gap-3 overflow-y-auto pr-1 flex-1",children:l.map(e=>(0,d.jsxs)(c.Card,{className:`border-l-4 cursor-pointer hover:bg-slate-50 transition-colors ${"meal"===e.type?"border-l-orange-500":"border-l-blue-500"}`,onClick:()=>s.handleNotificationClick(e),children:[(0,d.jsxs)("div",{className:"flex justify-between items-start",children:[(0,d.jsxs)("span",{className:"font-bold text-slate-700",children:[e.room,"호"]}),(0,d.jsx)("span",{className:"text-xs text-slate-400",children:e.time})]}),(0,d.jsx)("p",{className:"text-sm text-slate-600 mt-1",children:e.content})]},e.id))})]}),p&&(0,d.jsx)(eu,{isOpen:!!x,onClose:()=>s.setSelectedRoom(null),bed:p,notifications:l,onCompleteRequest:(e,t,s)=>n(e,t,s),lastUploadedIv:r,onIVUploadSuccess:e=>{void 0!==e&&x&&s.setBeds(t=>t.map(t=>String(t.room)===x?{...t,drops:e}:t))},onVitalUpdate:e=>{x&&s.setBeds(t=>t.map(t=>String(t.room)===x?{...t,temp:e,last_vital_at:new Date().toISOString(),status:e>=38||t.had_fever_in_6h?"fever":"normal"}:t))},lastUpdated:i}),m&&(0,d.jsx)(ep,{isOpen:!!m,onClose:()=>s.setQrBed(null),patientName:m.name,roomNumber:m.room,token:m.token}),(0,d.jsx)(eb,{isOpen:!!u,onClose:()=>s.setAdmitRoom(null),roomNumber:u||"",onAdmit:s.handleAdmit})]})}e.s(["default",()=>e_],80526)}]);